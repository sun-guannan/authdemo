{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getUsernameValidation = getUsernameValidation;\nexports.setUsername = setUsername;\nexports.usernameLooksLikeEmail = usernameLooksLikeEmail;\nvar _index = require(\"./index\");\nvar _email = require(\"./email\");\nvar _database = require(\"../connection/database\");\nvar _trim = _interopRequireDefault(require(\"trim\"));\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nvar DEFAULT_CONNECTION_VALIDATION = {\n  username: {\n    min: 1,\n    max: 15\n  }\n};\nvar regExp = /^[a-zA-Z0-9_+\\-.!#\\$\\^`~@']*$/;\nfunction validateUsername(str, validateFormat) {\n  var settings = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : DEFAULT_CONNECTION_VALIDATION.username;\n  var strictValidation = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  // If the connection does not have validation settings, it should only check if the field is empty.\n  // validateFormat overrides this logic to disable validation on login (login should never validate format)\n  if (!validateFormat || settings == null) {\n    return (0, _trim.default)(str).length > 0;\n  }\n  var lowercased = (0, _trim.default)(str.toLowerCase());\n\n  // check min value matched\n  if (lowercased.length < settings.min) {\n    return false;\n  }\n\n  // check max value matched\n  if (lowercased.length > settings.max) {\n    return false;\n  }\n\n  // check if user name is an email\n  if (strictValidation && (0, _email.validateEmail)(str) === true) {\n    return false;\n  }\n\n  // check allowed characters matched\n  var result = regExp.exec(lowercased);\n  return !!(result && result[0]);\n}\nfunction getUsernameValidation(m) {\n  var usernameValidation = (0, _database.databaseConnection)(m).getIn(['validation', 'username']);\n  return usernameValidation ? usernameValidation.toJS() : null;\n}\nfunction setUsername(m, str) {\n  var usernameStyle = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'username';\n  var validateUsernameFormat = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n  var strictValidation = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n  var usernameValidation = validateUsernameFormat ? getUsernameValidation(m) : null;\n  var validator = function validator(value) {\n    switch (usernameStyle) {\n      case 'email':\n        return (0, _email.validateEmail)(value);\n      case 'username':\n        return validateUsername(value, validateUsernameFormat, usernameValidation, strictValidation);\n      default:\n        return usernameLooksLikeEmail(value) ? (0, _email.validateEmail)(value) : validateUsername(value, validateUsernameFormat, usernameValidation, strictValidation);\n    }\n  };\n  return (0, _index.setField)(m, 'username', str, validator);\n}\nfunction usernameLooksLikeEmail(str) {\n  return str.indexOf('@') > -1 && str.indexOf('.') > -1;\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","getUsernameValidation","setUsername","usernameLooksLikeEmail","_index","require","_email","_database","_trim","_interopRequireDefault","obj","__esModule","default","DEFAULT_CONNECTION_VALIDATION","username","min","max","regExp","validateUsername","str","validateFormat","settings","arguments","length","undefined","strictValidation","lowercased","toLowerCase","validateEmail","result","exec","m","usernameValidation","databaseConnection","getIn","toJS","usernameStyle","validateUsernameFormat","validator","setField","indexOf"],"sources":["/Users/sunguannan/VisualStudioProjects/authdemo/node_modules/auth0-lock/lib/field/username.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getUsernameValidation = getUsernameValidation;\nexports.setUsername = setUsername;\nexports.usernameLooksLikeEmail = usernameLooksLikeEmail;\nvar _index = require(\"./index\");\nvar _email = require(\"./email\");\nvar _database = require(\"../connection/database\");\nvar _trim = _interopRequireDefault(require(\"trim\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nvar DEFAULT_CONNECTION_VALIDATION = {\n  username: {\n    min: 1,\n    max: 15\n  }\n};\nvar regExp = /^[a-zA-Z0-9_+\\-.!#\\$\\^`~@']*$/;\nfunction validateUsername(str, validateFormat) {\n  var settings = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : DEFAULT_CONNECTION_VALIDATION.username;\n  var strictValidation = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  // If the connection does not have validation settings, it should only check if the field is empty.\n  // validateFormat overrides this logic to disable validation on login (login should never validate format)\n  if (!validateFormat || settings == null) {\n    return (0, _trim.default)(str).length > 0;\n  }\n  var lowercased = (0, _trim.default)(str.toLowerCase());\n\n  // check min value matched\n  if (lowercased.length < settings.min) {\n    return false;\n  }\n\n  // check max value matched\n  if (lowercased.length > settings.max) {\n    return false;\n  }\n\n  // check if user name is an email\n  if (strictValidation && (0, _email.validateEmail)(str) === true) {\n    return false;\n  }\n\n  // check allowed characters matched\n  var result = regExp.exec(lowercased);\n  return !!(result && result[0]);\n}\nfunction getUsernameValidation(m) {\n  var usernameValidation = (0, _database.databaseConnection)(m).getIn(['validation', 'username']);\n  return usernameValidation ? usernameValidation.toJS() : null;\n}\nfunction setUsername(m, str) {\n  var usernameStyle = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'username';\n  var validateUsernameFormat = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n  var strictValidation = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n  var usernameValidation = validateUsernameFormat ? getUsernameValidation(m) : null;\n  var validator = function validator(value) {\n    switch (usernameStyle) {\n      case 'email':\n        return (0, _email.validateEmail)(value);\n      case 'username':\n        return validateUsername(value, validateUsernameFormat, usernameValidation, strictValidation);\n      default:\n        return usernameLooksLikeEmail(value) ? (0, _email.validateEmail)(value) : validateUsername(value, validateUsernameFormat, usernameValidation, strictValidation);\n    }\n  };\n  return (0, _index.setField)(m, 'username', str, validator);\n}\nfunction usernameLooksLikeEmail(str) {\n  return str.indexOf('@') > -1 && str.indexOf('.') > -1;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}