{"ast":null,"code":"var _ = require('../helper');\nfunction assert(options, password) {\n  if (!password) {\n    return false;\n  }\n  var i,\n    current = {\n      c: null,\n      count: 0\n    };\n  for (i = 0; i < password.length; i++) {\n    if (current.c !== password[i]) {\n      current.c = password[i];\n      current.count = 1;\n    } else {\n      current.count++;\n    }\n    if (current.count > options.max) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction explain(options, verified) {\n  var example = new Array(options.max + 2).join('a');\n  var d = {\n    message: 'No more than %d identical characters in a row (e.g., \"%s\" not allowed)',\n    code: 'identicalChars',\n    format: [options.max, example]\n  };\n  if (verified !== undefined) {\n    d.verified = verified;\n  }\n  return d;\n}\nmodule.exports = {\n  validate: function (options) {\n    if (!_.isObject(options)) {\n      throw new Error('options should be an object');\n    }\n    if (!_.isNumber(options.max) || _.isNaN(options.max) || options.max < 1) {\n      throw new Error('max should be a number greater than 1');\n    }\n    return true;\n  },\n  explain: explain,\n  missing: function (options, password) {\n    return explain(options, assert(options, password));\n  },\n  assert: assert\n};","map":{"version":3,"names":["_","require","assert","options","password","i","current","c","count","length","max","explain","verified","example","Array","join","d","message","code","format","undefined","module","exports","validate","isObject","Error","isNumber","isNaN","missing"],"sources":["/Users/sunguannan/VisualStudioProjects/authdemo/node_modules/password-sheriff/lib/rules/identicalChars.js"],"sourcesContent":["var _ = require('../helper');\n\nfunction assert(options, password) {\n  if (!password) {\n    return false;\n  }\n\n  var i, current = {c: null, count: 0};\n\n  for (i = 0; i < password.length; i++) {\n    if (current.c !== password[i]) {\n      current.c = password[i];\n      current.count = 1;\n    } else {\n      current.count++;\n    }\n\n    if (current.count > options.max) {\n      return false;\n    }\n  }\n\n  return true;\n}\nfunction explain (options, verified) {\n    var example = (new Array(options.max+2)).join('a');\n    var d = {\n      message: 'No more than %d identical characters in a row (e.g., \"%s\" not allowed)',\n      code: 'identicalChars',\n      format: [options.max, example]\n    };\n    if (verified !== undefined) {\n      d.verified = verified;\n    }\n    return d;\n  }\n\nmodule.exports = {\n  validate: function (options) {\n    if (!_.isObject(options)) {\n      throw new Error('options should be an object');\n    }\n\n    if (!_.isNumber(options.max) || _.isNaN(options.max) || options.max < 1 ) {\n      throw new Error('max should be a number greater than 1');\n    }\n\n    return true;\n  },\n  explain: explain,\n  missing: function (options, password) {\n    return explain(options, assert(options, password));\n  },\n  assert: assert\n};\n"],"mappings":"AAAA,IAAIA,CAAC,GAAGC,OAAO,CAAC,WAAW,CAAC;AAE5B,SAASC,MAAMA,CAACC,OAAO,EAAEC,QAAQ,EAAE;EACjC,IAAI,CAACA,QAAQ,EAAE;IACb,OAAO,KAAK;EACd;EAEA,IAAIC,CAAC;IAAEC,OAAO,GAAG;MAACC,CAAC,EAAE,IAAI;MAAEC,KAAK,EAAE;IAAC,CAAC;EAEpC,KAAKH,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,QAAQ,CAACK,MAAM,EAAEJ,CAAC,EAAE,EAAE;IACpC,IAAIC,OAAO,CAACC,CAAC,KAAKH,QAAQ,CAACC,CAAC,CAAC,EAAE;MAC7BC,OAAO,CAACC,CAAC,GAAGH,QAAQ,CAACC,CAAC,CAAC;MACvBC,OAAO,CAACE,KAAK,GAAG,CAAC;IACnB,CAAC,MAAM;MACLF,OAAO,CAACE,KAAK,EAAE;IACjB;IAEA,IAAIF,OAAO,CAACE,KAAK,GAAGL,OAAO,CAACO,GAAG,EAAE;MAC/B,OAAO,KAAK;IACd;EACF;EAEA,OAAO,IAAI;AACb;AACA,SAASC,OAAOA,CAAER,OAAO,EAAES,QAAQ,EAAE;EACjC,IAAIC,OAAO,GAAI,IAAIC,KAAK,CAACX,OAAO,CAACO,GAAG,GAAC,CAAC,CAAC,CAAEK,IAAI,CAAC,GAAG,CAAC;EAClD,IAAIC,CAAC,GAAG;IACNC,OAAO,EAAE,wEAAwE;IACjFC,IAAI,EAAE,gBAAgB;IACtBC,MAAM,EAAE,CAAChB,OAAO,CAACO,GAAG,EAAEG,OAAO;EAC/B,CAAC;EACD,IAAID,QAAQ,KAAKQ,SAAS,EAAE;IAC1BJ,CAAC,CAACJ,QAAQ,GAAGA,QAAQ;EACvB;EACA,OAAOI,CAAC;AACV;AAEFK,MAAM,CAACC,OAAO,GAAG;EACfC,QAAQ,EAAE,SAAAA,CAAUpB,OAAO,EAAE;IAC3B,IAAI,CAACH,CAAC,CAACwB,QAAQ,CAACrB,OAAO,CAAC,EAAE;MACxB,MAAM,IAAIsB,KAAK,CAAC,6BAA6B,CAAC;IAChD;IAEA,IAAI,CAACzB,CAAC,CAAC0B,QAAQ,CAACvB,OAAO,CAACO,GAAG,CAAC,IAAIV,CAAC,CAAC2B,KAAK,CAACxB,OAAO,CAACO,GAAG,CAAC,IAAIP,OAAO,CAACO,GAAG,GAAG,CAAC,EAAG;MACxE,MAAM,IAAIe,KAAK,CAAC,uCAAuC,CAAC;IAC1D;IAEA,OAAO,IAAI;EACb,CAAC;EACDd,OAAO,EAAEA,OAAO;EAChBiB,OAAO,EAAE,SAAAA,CAAUzB,OAAO,EAAEC,QAAQ,EAAE;IACpC,OAAOO,OAAO,CAACR,OAAO,EAAED,MAAM,CAACC,OAAO,EAAEC,QAAQ,CAAC,CAAC;EACpD,CAAC;EACDF,MAAM,EAAEA;AACV,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}