{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkSession = checkSession;\nexports.closeLock = closeLock;\nexports.handleAuthCallback = handleAuthCallback;\nexports.logIn = logIn;\nexports.logInSuccess = logInSuccess;\nexports.openLock = openLock;\nexports.pinLoadingPane = pinLoadingPane;\nexports.removeLock = removeLock;\nexports.resumeAuth = resumeAuth;\nexports.setupLock = setupLock;\nexports.unpinLoadingPane = unpinLoadingPane;\nexports.updateLock = updateLock;\nexports.validateAndSubmit = validateAndSubmit;\nvar _immutable = _interopRequireWildcard(require(\"immutable\"));\nvar _web_api = _interopRequireDefault(require(\"./web_api\"));\nvar _index = require(\"../store/index\");\nvar _remote_data = require(\"./remote_data\");\nvar l = _interopRequireWildcard(require(\"./index\"));\nvar _preload_utils = require(\"../utils/preload_utils\");\nvar _container = require(\"../ui/box/container\");\nvar _index3 = require(\"../field/index\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction _getRequireWildcardCache(e) {\n  if (\"function\" != typeof WeakMap) return null;\n  var r = new WeakMap(),\n    t = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(e) {\n    return e ? t : r;\n  })(e);\n}\nfunction _interopRequireWildcard(e, r) {\n  if (!r && e && e.__esModule) return e;\n  if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return {\n    default: e\n  };\n  var t = _getRequireWildcardCache(r);\n  if (t && t.has(e)) return t.get(e);\n  var n = {\n      __proto__: null\n    },\n    a = Object.defineProperty && Object.getOwnPropertyDescriptor;\n  for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) {\n    var i = a ? Object.getOwnPropertyDescriptor(e, u) : null;\n    i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u];\n  }\n  return n.default = e, t && t.set(e, n), n;\n}\nfunction _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _toPropertyKey(t) {\n  var i = _toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nfunction _toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nfunction setupLock(id, clientID, domain, options, hookRunner, emitEventFn, handleEventFn) {\n  var m = l.setup(id, clientID, domain, options, hookRunner, emitEventFn, handleEventFn);\n  m = (0, _remote_data.syncRemoteData)(m);\n  (0, _preload_utils.img)(l.ui.logo(m) || _container.defaultProps.logo);\n  _web_api.default.setupClient(id, clientID, domain, l.withAuthOptions(m, _objectSpread(_objectSpread({}, options), {}, {\n    popupOptions: l.ui.popupOptions(m)\n  })));\n  m = l.runHook(m, 'didInitialize', options);\n  (0, _index.swap)(_index.setEntity, 'lock', id, m);\n  return m;\n}\nfunction handleAuthCallback() {\n  var ms = (0, _index.read)(_index.getCollection, 'lock');\n  var keepHash = ms.filter(function (m) {\n    return !l.hashCleanup(m);\n  }).size > 0;\n  var urlWithoutHash = window.location.href.split('#')[0];\n  var callback = function callback(error, authResult) {\n    var parsed = !!(error || authResult);\n    if (parsed && !keepHash) {\n      window.history.replaceState(null, '', urlWithoutHash);\n    }\n  };\n  resumeAuth(window.location.hash, callback);\n}\nfunction resumeAuth(hash, callback) {\n  var ms = (0, _index.read)(_index.getCollection, 'lock');\n  ms.forEach(function (m) {\n    return l.auth.redirect(m) && parseHash(m, hash, callback);\n  });\n}\nfunction parseHash(m, hash, cb) {\n  _web_api.default.parseHash(l.id(m), hash, function (error, authResult) {\n    if (error) {\n      l.emitHashParsedEvent(m, error);\n    } else {\n      l.emitHashParsedEvent(m, authResult);\n    }\n    if (error) {\n      l.emitAuthorizationErrorEvent(m, error);\n    } else if (authResult) {\n      l.emitAuthenticatedEvent(m, authResult);\n    }\n    cb(error, authResult);\n  });\n}\nfunction openLock(id, opts) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (!m) {\n    throw new Error(\"The Lock can't be opened again after it has been destroyed\");\n  }\n  if (l.rendering(m)) {\n    return false;\n  }\n  if (opts.flashMessage) {\n    var supportedTypes = ['error', 'success', 'info'];\n    if (!opts.flashMessage.type || supportedTypes.indexOf(opts.flashMessage.type) === -1) {\n      return l.emitUnrecoverableErrorEvent(m, \"'flashMessage' must provide a valid type ['error','success','info']\");\n    }\n    if (!opts.flashMessage.text) {\n      return l.emitUnrecoverableErrorEvent(m, \"'flashMessage' must provide a text\");\n    }\n  }\n  l.emitEvent(m, 'show');\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    m = l.overrideOptions(m, opts);\n    m = l.filterConnections(m);\n    m = l.runHook(m, 'willShow', opts);\n    return l.render(m);\n  });\n  return true;\n}\nfunction closeLock(id) {\n  var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};\n  // Do nothing when the Lock can't be closed, unless closing is forced.\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (!l.ui.closable(m) && !force || !l.rendering(m)) {\n    return;\n  }\n  l.emitEvent(m, 'hide');\n\n  // If it is a modal, stop rendering an reset after a second,\n  // otherwise just reset.\n  if (l.ui.appendContainer(m)) {\n    (0, _index.swap)(_index.updateEntity, 'lock', id, l.stopRendering);\n    setTimeout(function () {\n      (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n        m = (0, _index3.hideInvalidFields)(m);\n        m = l.reset(m);\n        m = (0, _index3.clearFields)(m);\n        return m;\n      });\n      m = (0, _index.read)(_index.getEntity, 'lock', id);\n      callback(m);\n    }, 1000);\n  } else {\n    (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n      m = (0, _index3.hideInvalidFields)(m);\n      m = l.reset(m);\n      m = (0, _index3.clearFields)(m);\n      return m;\n    });\n    callback(m);\n  }\n}\nfunction removeLock(id) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, l.stopRendering);\n  (0, _index.swap)(_index.removeEntity, 'lock', id);\n}\nfunction updateLock(id, f) {\n  return (0, _index.swap)(_index.updateEntity, 'lock', id, f);\n}\nfunction pinLoadingPane(id) {\n  var lock = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (!lock.get('isLoadingPanePinned')) {\n    (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n      return m.set('isLoadingPanePinned', true);\n    });\n  }\n}\nfunction unpinLoadingPane(id) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    return m.set('isLoadingPanePinned', false);\n  });\n}\nfunction validateAndSubmit(id) {\n  var fields = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var f = arguments.length > 2 ? arguments[2] : undefined;\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    var allFieldsValid = fields.reduce(function (r, x) {\n      return r && (0, _index3.isFieldValid)(m, x);\n    }, true);\n    return allFieldsValid ? l.setSubmitting(m, true) : fields.reduce(function (r, x) {\n      return (0, _index3.showInvalidField)(r, x);\n    }, m);\n  });\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (l.submitting(m)) {\n    f(m);\n  }\n}\nfunction logIn(id, fields) {\n  var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var logInErrorHandler = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : function (_id, error, _fields, next) {\n    return next();\n  };\n  validateAndSubmit(id, fields, function (m) {\n    try {\n      // For now, always pass 'null' for the context as we don't need it yet.\n      // If we need it later, it'll save a breaking change in hooks already in use.\n      var context = null;\n      l.runHook(m, 'loggingIn', context, function () {\n        _web_api.default.logIn(id, params, l.auth.params(m).toJS(), function (error, result) {\n          if (error) {\n            setTimeout(function () {\n              return logInError(id, fields, error, logInErrorHandler);\n            }, 250);\n          } else {\n            logInSuccess(id, result);\n          }\n        });\n      });\n    } catch (e) {\n      setTimeout(function () {\n        return logInError(id, fields, e, logInErrorHandler);\n      }, 250);\n    }\n  });\n}\nfunction checkSession(id) {\n  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    return l.setSubmitting(m, true);\n  });\n  _web_api.default.checkSession(id, params, function (err, result) {\n    if (err) {\n      return logInError(id, [], err);\n    }\n    return logInSuccess(id, result);\n  });\n}\nfunction logInSuccess(id, result) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (!l.ui.autoclose(m)) {\n    (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n      m = l.setSubmitting(m, false);\n      return l.setLoggedIn(m, true);\n    });\n    l.emitAuthenticatedEvent(m, result);\n  } else {\n    closeLock(id, false, function (m1) {\n      return l.emitAuthenticatedEvent(m1, result);\n    });\n  }\n}\nfunction logInError(id, fields, error) {\n  var localHandler = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : function (_id, _error, _fields, next) {\n    return next();\n  };\n  var errorCode = error.error || error.code;\n  localHandler(id, error, fields, function () {\n    return setTimeout(function () {\n      var m = (0, _index.read)(_index.getEntity, 'lock', id);\n      var errorMessage = l.loginErrorMessage(m, error, loginType(fields));\n      var errorCodesThatEmitAuthorizationErrorEvent = ['blocked_user', 'rule_error', 'lock.unauthorized', 'invalid_user_password', 'login_required'];\n      if (errorCodesThatEmitAuthorizationErrorEvent.indexOf(errorCode) > -1) {\n        l.emitAuthorizationErrorEvent(m, error);\n      }\n      (0, _index.swap)(_index.updateEntity, 'lock', id, l.setSubmitting, false, errorMessage);\n    }, 0);\n  });\n  (0, _index.swap)(_index.updateEntity, 'lock', id, l.setSubmitting, false);\n}\nfunction loginType(fields) {\n  if (!fields) return;\n  if (~fields.indexOf('vcode')) return 'code';\n  if (~fields.indexOf('username')) return 'username';\n  if (~fields.indexOf('email')) return 'email';\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","checkSession","closeLock","handleAuthCallback","logIn","logInSuccess","openLock","pinLoadingPane","removeLock","resumeAuth","setupLock","unpinLoadingPane","updateLock","validateAndSubmit","_immutable","_interopRequireWildcard","require","_web_api","_interopRequireDefault","_index","_remote_data","l","_preload_utils","_container","_index3","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","_typeof","has","get","n","__proto__","a","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","o","Symbol","iterator","constructor","prototype","ownKeys","keys","getOwnPropertySymbols","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","key","_toPropertyKey","configurable","writable","_toPrimitive","toPrimitive","TypeError","String","Number","id","clientID","domain","options","hookRunner","emitEventFn","handleEventFn","m","setup","syncRemoteData","img","ui","logo","defaultProps","setupClient","withAuthOptions","popupOptions","runHook","swap","setEntity","ms","read","getCollection","keepHash","hashCleanup","size","urlWithoutHash","window","location","href","split","callback","error","authResult","parsed","history","replaceState","hash","auth","redirect","parseHash","cb","emitHashParsedEvent","emitAuthorizationErrorEvent","emitAuthenticatedEvent","opts","getEntity","Error","rendering","flashMessage","supportedTypes","type","indexOf","emitUnrecoverableErrorEvent","text","emitEvent","updateEntity","overrideOptions","filterConnections","render","force","undefined","closable","appendContainer","stopRendering","setTimeout","hideInvalidFields","reset","clearFields","removeEntity","f","lock","fields","allFieldsValid","reduce","x","isFieldValid","setSubmitting","showInvalidField","submitting","params","logInErrorHandler","_id","_fields","next","context","toJS","result","logInError","err","autoclose","setLoggedIn","m1","localHandler","_error","errorCode","code","errorMessage","loginErrorMessage","loginType","errorCodesThatEmitAuthorizationErrorEvent"],"sources":["/Users/sunguannan/VisualStudioProjects/authdemo/node_modules/auth0-lock/lib/core/actions.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkSession = checkSession;\nexports.closeLock = closeLock;\nexports.handleAuthCallback = handleAuthCallback;\nexports.logIn = logIn;\nexports.logInSuccess = logInSuccess;\nexports.openLock = openLock;\nexports.pinLoadingPane = pinLoadingPane;\nexports.removeLock = removeLock;\nexports.resumeAuth = resumeAuth;\nexports.setupLock = setupLock;\nexports.unpinLoadingPane = unpinLoadingPane;\nexports.updateLock = updateLock;\nexports.validateAndSubmit = validateAndSubmit;\nvar _immutable = _interopRequireWildcard(require(\"immutable\"));\nvar _web_api = _interopRequireDefault(require(\"./web_api\"));\nvar _index = require(\"../store/index\");\nvar _remote_data = require(\"./remote_data\");\nvar l = _interopRequireWildcard(require(\"./index\"));\nvar _preload_utils = require(\"../utils/preload_utils\");\nvar _container = require(\"../ui/box/container\");\nvar _index3 = require(\"../field/index\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction setupLock(id, clientID, domain, options, hookRunner, emitEventFn, handleEventFn) {\n  var m = l.setup(id, clientID, domain, options, hookRunner, emitEventFn, handleEventFn);\n  m = (0, _remote_data.syncRemoteData)(m);\n  (0, _preload_utils.img)(l.ui.logo(m) || _container.defaultProps.logo);\n  _web_api.default.setupClient(id, clientID, domain, l.withAuthOptions(m, _objectSpread(_objectSpread({}, options), {}, {\n    popupOptions: l.ui.popupOptions(m)\n  })));\n  m = l.runHook(m, 'didInitialize', options);\n  (0, _index.swap)(_index.setEntity, 'lock', id, m);\n  return m;\n}\nfunction handleAuthCallback() {\n  var ms = (0, _index.read)(_index.getCollection, 'lock');\n  var keepHash = ms.filter(function (m) {\n    return !l.hashCleanup(m);\n  }).size > 0;\n  var urlWithoutHash = window.location.href.split('#')[0];\n  var callback = function callback(error, authResult) {\n    var parsed = !!(error || authResult);\n    if (parsed && !keepHash) {\n      window.history.replaceState(null, '', urlWithoutHash);\n    }\n  };\n  resumeAuth(window.location.hash, callback);\n}\nfunction resumeAuth(hash, callback) {\n  var ms = (0, _index.read)(_index.getCollection, 'lock');\n  ms.forEach(function (m) {\n    return l.auth.redirect(m) && parseHash(m, hash, callback);\n  });\n}\nfunction parseHash(m, hash, cb) {\n  _web_api.default.parseHash(l.id(m), hash, function (error, authResult) {\n    if (error) {\n      l.emitHashParsedEvent(m, error);\n    } else {\n      l.emitHashParsedEvent(m, authResult);\n    }\n    if (error) {\n      l.emitAuthorizationErrorEvent(m, error);\n    } else if (authResult) {\n      l.emitAuthenticatedEvent(m, authResult);\n    }\n    cb(error, authResult);\n  });\n}\nfunction openLock(id, opts) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (!m) {\n    throw new Error(\"The Lock can't be opened again after it has been destroyed\");\n  }\n  if (l.rendering(m)) {\n    return false;\n  }\n  if (opts.flashMessage) {\n    var supportedTypes = ['error', 'success', 'info'];\n    if (!opts.flashMessage.type || supportedTypes.indexOf(opts.flashMessage.type) === -1) {\n      return l.emitUnrecoverableErrorEvent(m, \"'flashMessage' must provide a valid type ['error','success','info']\");\n    }\n    if (!opts.flashMessage.text) {\n      return l.emitUnrecoverableErrorEvent(m, \"'flashMessage' must provide a text\");\n    }\n  }\n  l.emitEvent(m, 'show');\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    m = l.overrideOptions(m, opts);\n    m = l.filterConnections(m);\n    m = l.runHook(m, 'willShow', opts);\n    return l.render(m);\n  });\n  return true;\n}\nfunction closeLock(id) {\n  var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};\n  // Do nothing when the Lock can't be closed, unless closing is forced.\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (!l.ui.closable(m) && !force || !l.rendering(m)) {\n    return;\n  }\n  l.emitEvent(m, 'hide');\n\n  // If it is a modal, stop rendering an reset after a second,\n  // otherwise just reset.\n  if (l.ui.appendContainer(m)) {\n    (0, _index.swap)(_index.updateEntity, 'lock', id, l.stopRendering);\n    setTimeout(function () {\n      (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n        m = (0, _index3.hideInvalidFields)(m);\n        m = l.reset(m);\n        m = (0, _index3.clearFields)(m);\n        return m;\n      });\n      m = (0, _index.read)(_index.getEntity, 'lock', id);\n      callback(m);\n    }, 1000);\n  } else {\n    (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n      m = (0, _index3.hideInvalidFields)(m);\n      m = l.reset(m);\n      m = (0, _index3.clearFields)(m);\n      return m;\n    });\n    callback(m);\n  }\n}\nfunction removeLock(id) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, l.stopRendering);\n  (0, _index.swap)(_index.removeEntity, 'lock', id);\n}\nfunction updateLock(id, f) {\n  return (0, _index.swap)(_index.updateEntity, 'lock', id, f);\n}\nfunction pinLoadingPane(id) {\n  var lock = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (!lock.get('isLoadingPanePinned')) {\n    (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n      return m.set('isLoadingPanePinned', true);\n    });\n  }\n}\nfunction unpinLoadingPane(id) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    return m.set('isLoadingPanePinned', false);\n  });\n}\nfunction validateAndSubmit(id) {\n  var fields = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var f = arguments.length > 2 ? arguments[2] : undefined;\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    var allFieldsValid = fields.reduce(function (r, x) {\n      return r && (0, _index3.isFieldValid)(m, x);\n    }, true);\n    return allFieldsValid ? l.setSubmitting(m, true) : fields.reduce(function (r, x) {\n      return (0, _index3.showInvalidField)(r, x);\n    }, m);\n  });\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (l.submitting(m)) {\n    f(m);\n  }\n}\nfunction logIn(id, fields) {\n  var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var logInErrorHandler = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : function (_id, error, _fields, next) {\n    return next();\n  };\n  validateAndSubmit(id, fields, function (m) {\n    try {\n      // For now, always pass 'null' for the context as we don't need it yet.\n      // If we need it later, it'll save a breaking change in hooks already in use.\n      var context = null;\n      l.runHook(m, 'loggingIn', context, function () {\n        _web_api.default.logIn(id, params, l.auth.params(m).toJS(), function (error, result) {\n          if (error) {\n            setTimeout(function () {\n              return logInError(id, fields, error, logInErrorHandler);\n            }, 250);\n          } else {\n            logInSuccess(id, result);\n          }\n        });\n      });\n    } catch (e) {\n      setTimeout(function () {\n        return logInError(id, fields, e, logInErrorHandler);\n      }, 250);\n    }\n  });\n}\nfunction checkSession(id) {\n  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    return l.setSubmitting(m, true);\n  });\n  _web_api.default.checkSession(id, params, function (err, result) {\n    if (err) {\n      return logInError(id, [], err);\n    }\n    return logInSuccess(id, result);\n  });\n}\nfunction logInSuccess(id, result) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  if (!l.ui.autoclose(m)) {\n    (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n      m = l.setSubmitting(m, false);\n      return l.setLoggedIn(m, true);\n    });\n    l.emitAuthenticatedEvent(m, result);\n  } else {\n    closeLock(id, false, function (m1) {\n      return l.emitAuthenticatedEvent(m1, result);\n    });\n  }\n}\nfunction logInError(id, fields, error) {\n  var localHandler = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : function (_id, _error, _fields, next) {\n    return next();\n  };\n  var errorCode = error.error || error.code;\n  localHandler(id, error, fields, function () {\n    return setTimeout(function () {\n      var m = (0, _index.read)(_index.getEntity, 'lock', id);\n      var errorMessage = l.loginErrorMessage(m, error, loginType(fields));\n      var errorCodesThatEmitAuthorizationErrorEvent = ['blocked_user', 'rule_error', 'lock.unauthorized', 'invalid_user_password', 'login_required'];\n      if (errorCodesThatEmitAuthorizationErrorEvent.indexOf(errorCode) > -1) {\n        l.emitAuthorizationErrorEvent(m, error);\n      }\n      (0, _index.swap)(_index.updateEntity, 'lock', id, l.setSubmitting, false, errorMessage);\n    }, 0);\n  });\n  (0, _index.swap)(_index.updateEntity, 'lock', id, l.setSubmitting, false);\n}\nfunction loginType(fields) {\n  if (!fields) return;\n  if (~fields.indexOf('vcode')) return 'code';\n  if (~fields.indexOf('username')) return 'username';\n  if (~fields.indexOf('email')) return 'email';\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}